!function(e,a){"object"==typeof exports&&"undefined"!=typeof module?a(exports,require("@angular/core")):"function"==typeof define&&define.amd?define("ngx-vcard",["exports","@angular/core"],a):a((e="undefined"!=typeof globalThis?globalThis:e||self)["ngx-vcard"]={},e.ng.core)}(this,(function(e,a){"use strict";var n;function r(e){return e?("string"!=typeof e&&(e=""+e),e.replace(/\n/g,"\n").replace(/,/g,",").replace(/;/g,";")):""}function o(e){var a="";return e.language&&(a+=";LANGUAGE="+r(e.language)),e.value&&(a+=";VALUE="+r(e.value)),e.altid&&(a+=";ALTID="+r(e.altid)),e.pid&&(a+=";PID="+e.pid.map((function(e){return r(e)})).join(",")),e.type&&(Array.isArray(e.type)?1===e.type.length?a+=";TYPE="+e.type[0]:a+=';TYPE="'+e.type.map((function(e){return e.toLowerCase()})).join(",")+'"':a+=";TYPE="+e.type),e.mediatype&&(a+=";MEDIATYPE="+r(e.mediatype)),e.pref&&(a+=";PREF="+e.pref),e.calscale&&(a+=";CALSCALE="+r(e.calscale)),e.sortas&&(a+=';SORT-AS="'+e.sortas.map((function(e){return r(e)})).join(",")+'"'),e.geo&&(a+=";GEO="+r(e.geo)),e.timezone&&(a+=";TZ="+r(e.timezone)),a}function t(e){var a=e;return null!=a&&null!=a.param&&null!=a.value&&(void 0!==a.param.language||void 0!==a.param.value||void 0!==a.param.pref||void 0!==a.param.altid||void 0!==a.param.pid||void 0!==a.param.type||void 0!==a.param.mediatype||void 0!==a.param.calscale||void 0!==a.param.sortas||void 0!==a.param.geo||void 0!==a.param.timezone)}function i(e){var a=e;return null!=a&&null!=a.param&&null!=a.value&&(void 0!==a.param.language||void 0!==a.param.value||void 0!==a.param.pref||void 0!==a.param.altid||void 0!==a.param.pid||void 0!==a.param.type||void 0!==a.param.mediatype||void 0!==a.param.calscale||void 0!==a.param.sortas||void 0!==a.param.geo||void 0!==a.param.timezone)}(n=e.VCardEncoding||(e.VCardEncoding={})).none="",n.utf8=";CHARSET=utf-8";var l=function(){function a(){}return a.getVCardAsBlob=function(n,r){void 0===r&&(r=e.VCardEncoding.none);var o=a.getVCardAsString(n,r);return new Blob([o],{type:"text/vcard"})},a.getVCardAsString=function(a,n){void 0===n&&(n=e.VCardEncoding.none),a.version||(a.version="4.0");var l=u(a.version),p="";p+="BEGIN:VCARD\n",p+="VERSION:"+a.version+"\n";var m;null==a.name&&(a.name={});if(m=(null!=a.formattedName?[a.formattedName.firstNames,a.formattedName.addtionalNames,a.formattedName.lastNames]:[a.name.firstNames,a.name.addtionalNames,a.name.lastNames]).filter((function(e){return null!=e})).join(" "),p+="FN"+n+":"+r(m)+"\n",p+="N"+n+":"+[r(a.name.lastNames),r(a.name.firstNames),r(a.name.addtionalNames),r(a.name.namePrefix),r(a.name.nameSuffix)].join(";")+"\n",a.nickname&&l>=3&&(p+="NICKNAME"+n+":"+r(a.nickname)+"\n"),a.gender&&(a.gender.sex?(p+="GENDER:"+r(a.gender.sex),a.gender.text&&(p+=";"+r(a.gender.text)),p+="\n"):p+="GENDER:;"+r(a.gender.text)+"\n"),a.uid&&(p+="UID"+n+":"+r(a.uid)+"\n"),a.birthday&&(p+="BDAY:"+s(a.birthday)+"\n"),a.anniversary&&(p+="ANNIVERSARY:"+s(a.anniversary)+"\n"),a.language&&a.language.forEach((function(e){t(e)?p+="LANG"+o(e.param)+":"+r(e.value)+"\n":p+="LANG:"+r(e)+"\n"})),a.organization&&(t(a.organization)?p+="ORG"+o(a.organization.param)+":"+r(a.organization.value)+"\n":p+="ORG"+n+":"+r(a.organization)+"\n"),a.address&&a.address.forEach((function(e){i(e)?p+="ADR"+o(e.param)+d(e.value)+"\n":p+="ADR"+d(e)+"\n"})),a.telephone&&a.telephone.forEach((function(e){t(e)||(e={value:e,param:{type:"voice"}}),p+="TEL"+o(e.param)+":"+r(e.value)+"\n"})),a.email&&a.email.forEach((function(e){t(e)?p+="EMAIL"+o(e.param)+":"+r(e.value)+"\n":p+="EMAIL:"+r(e)+"\n"})),a.title&&(p+="TITLE"+n+":"+r(a.title)+"\n"),a.logo&&(t(a.logo)?p+="LOGO"+o(a.logo.param)+":"+r(a.logo.value)+"\n":p+="LOGO:"+r(a.logo)+"\n"),a.photo&&(t(a.photo)?p+="PHOTO"+o(a.photo.param)+":"+r(a.photo.value)+"\n":p+="PHOTO:"+r(a.photo)+"\n"),a.homeFax&&a.homeFax.forEach((function(e){p+=+l>=4?'TEL;VALUE=uri;TYPE="fax,home":tel:'+r(e)+"\n":"TEL;TYPE=HOME,FAX:"+r(e)+"\n"})),a.workFax&&a.workFax.forEach((function(e){p+=+l>=4?'TEL;VALUE=uri;TYPE="fax,work":tel:'+r(e)+"\n":"TEL;TYPE=WORK,FAX:"+r(e)+"\n"})),a.role&&(p+="ROLE"+n+":"+r(a.role)+"\n"),a.url){var v=!0;c(a.url,"home")&&(p+="URL;type=WORK"+n+":"+r(a.url.home)+"\n",v=!1),c(a.url,"work")&&(p+="URL;type=WORK"+n+":"+r(a.url.work)+"\n",v=!1),v&&(p+="URL"+n+":"+r(a.url)+"\n")}if(a.note&&(p+="NOTE"+n+":"+r(a.note)+"\n"),a.socialUrls)for(var f in a.socialUrls)a.socialUrls.hasOwnProperty(f)&&a.socialUrls[f]&&(p+="X-SOCIALPROFILE"+n+";TYPE="+f+":"+r(a.socialUrls[f])+"\n");return a.source&&(t(a.source)?p+="SOURCE"+n+o(a.source.param)+":"+r(a.source.value)+0:p+="SOURCE"+n+":"+r(a.source)+"\n"),a.rev&&(p+="REV:"+a.rev+"\n"),p+="END:VCARD\n"},a}();function d(e){return(e.label?';LABEL="'+r(e.label)+'"':"")+":"+r(e.postOfficeBox)+";"+r(e.extendedAddress)+";"+r(e.street)+";"+r(e.locality)+";"+r(e.region)+";"+r(e.postalCode)+";"+r(e.countryName)}function s(e){return e?e.toLocaleDateString("se").replace(/\D/g,""):""}function u(e){var a=e?e.slice(0,1):"4";return isNaN(+a)?4:Number.parseInt(a)}function c(e,a){return Object.prototype.hasOwnProperty.call(e,a)}var p=function(){function a(a){this.element=a,this.encoding=e.VCardEncoding.none}return a.prototype.onclick=function(){var e=l.getVCardAsBlob(this.vCard,this.encoding),a="vCard";null!=this.vCard.name&&(a=this.vCard.name.firstNames+" "+this.vCard.name.lastNames+".vcf"),this.download(e,a)},a.prototype.download=function(e,a){if(window.navigator.msSaveBlob)window.navigator.msSaveBlob(e,a);else{var n=document.createElement("a"),r=URL.createObjectURL(e);n.style.display="none",n.href=r,n.download=a,document.body.appendChild(n),n.click(),setTimeout((function(){document.body.removeChild(n),window.URL.revokeObjectURL(r)}),1e3)}},a}();p.decorators=[{type:a.Directive,args:[{selector:"[vcdDownloadVCard]"}]}],p.ctorParameters=function(){return[{type:a.ElementRef}]},p.propDecorators={vCard:[{type:a.Input,args:["vcdDownloadVCard"]}],encoding:[{type:a.Input}],onclick:[{type:a.HostListener,args:["click"]}]};var m=function(){};m.decorators=[{type:a.NgModule,args:[{imports:[],declarations:[p],exports:[p]}]}],e.DownloadVCardDirective=p,e.NgxVcardModule=m,e.VCardFormatter=l,e.getMajorVersion=u,e.isPropertyWithParameters=t,e.isPropertyWithParametersAddressValue=i,e.propertyToVCardString=o,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-vcard.umd.min.js.map